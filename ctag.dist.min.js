!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";function r(){}function a(e){if(!(this instanceof a))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(e,this)}function i(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,a._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void s(r.promise,e)}o(r.promise,t)}else(1===n._state?o:s)(r.promise,n._value)})):n._deferreds.push(r)}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof a)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void u((r=n,i=e,function(){r.apply(i,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){s(t,e)}var r,i}function s(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&a._immediateFn(function(){e._handled||a._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)i(e,e._deferreds[t]);e._deferreds=null}function u(e,t){var n=!1;try{e(function(e){n||(n=!0,o(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}var e=function(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},t=setTimeout;a.prototype.catch=function(e){return this.then(null,e)},a.prototype.then=function(e,t){var n=new this.constructor(r);return i(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},a.prototype.finally=e,a.all=function(t){return new a(function(r,i){function a(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){a(t,e)},i)}o[t]=e,0==--s&&r(o)}catch(e){i(e)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var o=Array.prototype.slice.call(t);if(0===o.length)return r([]);for(var s=o.length,e=0;o.length>e;e++)a(e,o[e])})},a.resolve=function(t){return t&&"object"==typeof t&&t.constructor===a?t:new a(function(e){e(t)})},a.reject=function(n){return new a(function(e,t){t(n)})},a.race=function(i){return new a(function(e,t){for(var n=0,r=i.length;n<r;n++)i[n].then(e,t)})},a._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){t(e,0)},a._unhandledRejectionFn=function(e){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();n.Promise?n.Promise.prototype.finally||(n.Promise.prototype.finally=e):n.Promise=a});var CTAG,TemplateTranspiler={};TemplateTranspiler.Functions={},TemplateTranspiler.UID=function(){function e(){}return e.Generate=function(){function e(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",n=0;n<5;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}return e()+e()+"_"+e()+"_"+e()+"_"+e()+"_"+e()+e()+e()},e}(),TemplateTranspiler.Parser=function(){function e(){this._domParser=new DOMParser,this._random_name=TemplateTranspiler.UID.Generate(),this._tag_count=0}return e.prototype.TemplateInstanceList=[],e.prototype.TranspileNode=function(e,t){var n="a_"+this._random_name+"_"+this._tag_count++,r="";if("#text"==e.nodeName)return""==e.data.replace(/[\r\n]+/g," ").trim()?"":(r+="var "+n+" = document.createElement('SPAN');",r+=n+".innerHTML += '"+e.data.replace(/[\r\n]+/g," ")+"';",r+=t+".appendChild("+n+");");r+="var "+n+" = document.createElement('"+e.tagName.toUpperCase()+"');";for(var i=0;i<e.attributes.length;i++)r+=n+".setAttribute('"+e.attributes[i].name+"', '"+e.attributes[i].value+"');";if(0<e.childNodes.length)for(i=0;i<e.childNodes.length;i++)r+=this.TranspileNode(e.childNodes[i],n);else r+=n+".textContent = '"+e.innerHTML.replace(/[\r\n]+/g," ")+"';";return e.hasAttribute("eid")?(r+=t+".appendChild("+n+");",r+="childObjects."+e.getAttribute("eid")+" = "+n+";"):r+=t+".appendChild("+n+");",r},e.prototype.Parse=function(e){this.TemplateInstanceList=[];for(var t=this._domParser.parseFromString(e,"text/html"),n="",r=0;r<t.body.childNodes.length;r++)n+=this.TranspileNode(t.body.childNodes[r],"target");return n},e.prototype.GenerateDrawerFuction=function(e,t){var n="TemplateTranspiler.Functions."+e+" = function(target, async){";n+="return new Promise(function(resolve, reject){",n+="if (async!=false){",n+="window.setTimeout(function(){",n+="var childObjects = {};",n+=this.Parse(t),n+="resolve(childObjects);",n+="},0);",n+="}else{",n+="var childObjects = {};",n+=this.Parse(t),n+="resolve(childObjects);",n+="}",n+="});",n+="};";var r=document.createElement("SCRIPT");r.innerHTML=n,document.head.appendChild(r)},e}(),function(o){o.Settings={},o.Settings.asyncRegistration=!1,o.Settings.asyncCssHackRendering=!1,o.Settings.asyncChildRendering=!1,o.Settings.asyncStyleRegistration=!1;var e=function(){function e(){}return e.template="",e.styles="",e.registered=!1,e.stylesRegistered=!1,e.prototype.setStyles=function(e,t){r.registerTargetedStyle(t,this.tagName,e)},e.prototype.attr=function(e){var t=this.body.getAttribute(e);return null==t?"":t},e}();o.CtagBase=e;var f=function(){function n(){}return n.tagList={},n.styleList=[],n.styleTargets=[],n.styleVariableList=[],n.identifiedInstances=[],n.identifiedNotifiers=[],n.bindToTag=function(e,t){e=e.toLowerCase(),null==n.tagList[e]?(n.tagList[e]=t,r.monitorTag(e)):console.error("Ctag: This tag is already bound to a class.")},n.registerVariable=function(e,t){n.styleVariableList[e]=t},n.registerId=function(e,t){n.identifiedInstances[e]=t},n}();o.CtagRegistry=f;var a=function(){function e(){}return e.getMatches=function(e,t,n){n||(n=1);for(var r,i=[];r=t.exec(e);)i.push(r[n]);return i},e}();o.RegExExtensions=a;var s=function(){function e(){}return e.renderCss=function(e,t){var n=e.replace(/(this\.)+/gi,t+" ."),r=a.getMatches(n,/~{([\d|\w|_]+)}/g,1);r=r.filter(function(e,t,n){return n.indexOf(e)===t});for(var i=0;i<r.length;i++)null!=f.styleVariableList[r[i]]&&(n=n.replace(new RegExp("(~{"+r[i]+"})","g"),f.styleVariableList[r[i]]));return n},e}();o.Renderer=s;var r=function(){function d(){}return d.cssHackBaseElement=null,d.initialized=!1,d.initialize=function(){(d.cssHackBaseElement=document.createElement("STYLE")).setAttribute("type","text/css"),d.cssHackBaseElement.textContent="@keyframes nodeInserted{from{outline-color:#fff}to{outline-color:#000}}@-moz-keyframes nodeInserted{from{outline-color:#fff}to{outline-color:#000}}@-webkit-keyframes nodeInserted{from{outline-color:#fff}to{outline-color:#000}}@-ms-keyframes nodeInserted{from{outline-color:#fff}to{outline-color:#000}}@-o-keyframes nodeInserted{from{outline-color:#fff}to{outline-color:#000}}","Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/rv:11/)||void 0!==$.browser&&1==$.browser.msie||(document.addEventListener("animationstart",function(e){d.render({target:e.target},o.Settings.asyncCssHackRendering)},!0),document.addEventListener("MSAnimationStart",function(e){d.render({target:e.target},o.Settings.asyncCssHackRendering)},!0),document.addEventListener("webkitAnimationStart",function(e){d.render({target:e.target},o.Settings.asyncCssHackRendering)},!0)),document.head.appendChild(d.cssHackBaseElement)},d.render=function(l,n){return new Promise(function(s,e){var t=f.tagList[l.target.tagName.toLowerCase()];if(null!=t&&null==l.target.getAttribute("ctag-rendered")){var c=new t;c.tagName=l.target.tagName.toLowerCase();var u=l.target.innerHTML;if(l.target.textContent="",c.body=l.target,c.children={},!t.registered)t.registered=!0,(new TemplateTranspiler.Parser).GenerateDrawerFuction(l.target.tagName,t.template);t.stylesRegistered||(t.stylesRegistered=!0,d.registerStyle(t.styles,l.target.tagName)),TemplateTranspiler.Functions[l.target.tagName](c.body,n).then(function(e){c.elements=e;for(var t=[],n=Object.keys(f.tagList),r=0;r<n.length;r++)for(var i=c.body.querySelectorAll(n[r]),a=0;a<i.length;a++)t.push(d.render({target:i[a]},o.Settings.asyncChildRendering));Promise.all(t).then(function(e){var t=c.existingElementTarget;if(null!=t){t.innerHTML=u;for(var n=Object.keys(f.tagList),r=0;r<n.length;r++)for(var i=t.querySelectorAll(n[r]),a=0;a<i.length;a++)e.concat(d.render({target:i[a]},!1))}for(r=0;r<e.length;r++)null!=e[r].body.getAttribute("eid")&&(c.children[e[r].body.getAttribute("eid")]=e[r]);c.load();var o=l.target.getAttribute("id");null!=o&&(f.registerId(o,c),null!=f.identifiedNotifiers[o]&&f.identifiedNotifiers[o](c));for(r=0;r<l.target.attributes.length;r++)l.target.children[0].setAttribute(l.target.attributes[r].name,l.target.attributes[r].value);l.target.setAttribute("ctag-rendered","true"),s(c)})})}else s(null)})},d.registerStyle=function(r,i){return new Promise(function(e,t){var n=function(){if(null==f.styleList[i]){var e=s.renderCss(r,i);f.styleList[i]=e;var t=document.createElement("STYLE");t.textContent=e,document.head.appendChild(t)}};o.Settings.asyncStyleRegistration?setTimeout(function(){n(),e()},0):(n(),e())})},d.registerTargetedStyle=function(e,t,n){var r,i=s.renderCss(e,t);null==f.styleTargets[t+"_"+n]?((r=document.createElement("STYLE")).textContent=i,f.styleTargets[t+"_"+n]=r,document.head.appendChild(r)):(r=f.styleTargets[t+"_"+n]).textContent=i},d.monitorTag=function(e){d.cssHackBaseElement.textContent+=e+"{animation-duration:0.01s;-o-animation-duration:0.01s;-ms-animation-duration:0.01s;-moz-animation-duration:0.01s;-webkit-animation-duration:0.01s;animation-name:nodeInserted;-o-animation-name:nodeInserted;-ms-animation-name:nodeInserted;-moz-animation-name:nodeInserted;-webkit-animation-name:nodeInserted}"},d.getById=function(e,t){return f.identifiedInstances[e]},d.ctagLoaded=function(n){return new Promise(function(e,t){f.identifiedNotifiers[n]=e})},d}();o.DomManager=r}(CTAG||(CTAG={})),document.addEventListener("DOMContentLoaded",function(){CTAG.DomManager.initialize();var e=document.createEvent("Event");e.initEvent("CtagSetVariables",!1,!0),document.dispatchEvent(e);var t=document.createEvent("Event");t.initEvent("CtagBind",!0,!0),document.dispatchEvent(t);for(var n=Object.keys(CTAG.CtagRegistry.tagList),r=0;r<n.length;r++)for(var i=document.querySelectorAll(n[r]),a=0;a<i.length;a++){var o=i[a];CTAG.DomManager.render({target:o},CTAG.Settings.asyncRegistration)}("Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/rv:11/)||void 0!==$.browser&&1==$.browser.msie)&&(document.addEventListener("animationstart",function(e){var t=e;DomManager.render({target:t.target},CTAG.Settings.asyncCssHackRendering)},!0),document.addEventListener("MSAnimationStart",function(e){var t=e;DomManager.render({target:t.target},CTAG.Settings.asyncCssHackRendering)},!0),document.addEventListener("webkitAnimationStart",function(e){var t=e;DomManager.render({target:t.target},CTAG.Settings.asyncCssHackRendering)},!0));var s=document.createEvent("Event");s.initEvent("CtagReady",!1,!0),document.dispatchEvent(s)});